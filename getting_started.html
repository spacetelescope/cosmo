

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; COSMO 1.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="COS Monitors" href="monitors.html" />
    <link rel="prev" title="COSMO (COS Monitoring)" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> COSMO
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing">Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cosmo-settings-with-a-configuration-file">COSMO Settings with a configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crds">CRDS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executing-monitors">Executing Monitors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="monitors.html">COS Monitors</a></li>
<li class="toctree-l1"><a class="reference internal" href="datamodels.html">DataModels</a></li>
<li class="toctree-l1"><a class="reference internal" href="sms.html">SMS Data Ingestion</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COSMO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Getting Started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>COSMO is intended to be installed and its monitors run either manually or via cronjob.
Use of COSMO outside of the scope of executing the monitors that are defined is not recommended, however, the data
models and their API can be used to access the monitoring data for use outside the scope of this project if needed.</p>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h2>
<p>Before installing COSMO, be sure to create an environment with python 3.7+ at minimum.
A good starting point would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">cosmo_env</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.7</span> <span class="n">stsci</span>
</pre></div>
</div>
<p>For developers, also including <code class="docutils literal notranslate"><span class="pre">coverage</span></code> is also recommended (but not mandatory).</p>
<p>After an environment has been prepared, clone the repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">spacetelescope</span><span class="o">/</span><span class="n">cosmo</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Then install using pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">cosmo</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cosmo-settings-with-a-configuration-file">
<h3>COSMO Settings with a configuration file<a class="headerlink" href="#cosmo-settings-with-a-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>To manage configurations, COSMO uses a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> configuration file.
Create a yaml configuration file with the following format:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for obtaining data from files</span>
<span class="nt">filesystem</span><span class="p">:</span>
  <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;&#39;</span>  <span class="c1"># Path to the source files</span>

<span class="c1"># Settings for obtaining data from sms files and setting up the sms database</span>
<span class="nt">sms</span><span class="p">:</span>
  <span class="nt">source</span><span class="p">:</span> <span class="s">&#39;&#39;</span>  <span class="c1"># This is the path where the sms files exist</span>
  <span class="nt">db_settings</span><span class="p">:</span>  <span class="c1"># These are database keyword arguments</span>
    <span class="nt">database</span><span class="p">:</span> <span class="s">&#39;&#39;</span>  <span class="c1"># Path to sqlite database file</span>
    <span class="nt">pragmas</span><span class="p">:</span>  <span class="c1"># sqlite database connection configurations.</span>
      <span class="nt">journal_mode</span><span class="p">:</span> <span class="s">&#39;wal&#39;</span>
      <span class="nt">foreign_keys</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">ignore_check_constraints</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="nt">synchronous</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="nt">output</span><span class="p">:</span> <span class="s">&#39;&#39;</span>
</pre></div>
</div>
<p>For more information on sqlite pragma statements, see <a class="reference external" href="https://www.sqlite.org/pragma.html">this</a>.</p>
<p>Once the file is ready, set it as an environment variable, <code class="docutils literal notranslate"><span class="pre">COSMO_CONFIG</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">monitorframe</span></code> also requires a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> configuration file with the following:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Monitor data database</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">db_settings</span><span class="p">:</span>
    <span class="nt">database</span><span class="p">:</span> <span class="s">&#39;&#39;</span>
    <span class="nt">pragmas</span><span class="p">:</span>
      <span class="nt">journal_mode</span><span class="p">:</span> <span class="s">&#39;wal&#39;</span>
      <span class="nt">foreign_keys</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">ignore_check_constraints</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="nt">synchronous</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="c1"># Monitor status and results database</span>
<span class="nt">results</span><span class="p">:</span>
  <span class="nt">db_settings</span><span class="p">:</span>
    <span class="nt">database</span><span class="p">:</span> <span class="s">&#39;&#39;</span>
    <span class="nt">pragmas</span><span class="p">:</span>
      <span class="nt">journal_mode</span><span class="p">:</span> <span class="s">&#39;wal&#39;</span>
      <span class="nt">foreign_keys</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">ignore_check_constraints</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
      <span class="nt">synchronous</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>This configuration file should be set to an environment variable called <code class="docutils literal notranslate"><span class="pre">MONITOR_CONFIG</span></code>.</p>
<p>You can store both of these configurations in one file and have both of the environment variables point to that single
file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use proper precautions around your configuration file.
It may or may not contain sensitive information, so please ensure that permissions on that file are restricted to
the intended users.
DON’T push it to GitHub!</p>
</div>
</div>
<div class="section" id="crds">
<h3>CRDS<a class="headerlink" href="#crds" title="Permalink to this headline">¶</a></h3>
<p>Some of the COSMO DataModels utilize data from reference files, and take advantage of <code class="docutils literal notranslate"><span class="pre">crds</span></code> to do so.
For configuration and setup instructions for using <code class="docutils literal notranslate"><span class="pre">crds</span></code>, see
<a class="reference external" href="https://hst-crds.stsci.edu/static/users_guide/environment.html">the crds user manual</a>.</p>
<p>At minimum, users will need access to a CRDS cache with the following reference file types:</p>
<ul class="simple">
<li><p>LAMPTAB</p></li>
<li><p>WCPTAB</p></li>
</ul>
<p>Since the COSMO monitors use data from reference files across time, it would be best to get all files of those types
available in the <em>active context</em>.</p>
<p>The easiest way to ensure that the local CRDS cache has everything required, users can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crds</span> <span class="n">sync</span> <span class="o">--</span><span class="n">contexts</span> <span class="n">hst</span><span class="o">-</span><span class="n">cos</span><span class="o">-</span><span class="n">operational</span> <span class="o">--</span><span class="n">fetch</span><span class="o">-</span><span class="n">references</span>
</pre></div>
</div>
<p>This command with download <em>all</em> COS reference files and mappings to the <code class="docutils literal notranslate"><span class="pre">CRDS_CACHE</span></code> (see the instructions mentioned
above).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The command given above works well, but there’s a caveat: it requires a large amount of available storage space at
the cache location (between 2-3 GB).</p>
</div>
</div>
</div>
<div class="section" id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>COSMO includes a suite of tests for the package.
For developers, it’s a good idea to execute these tests whenever there are changes to the code or environment.</p>
<p>Before executing tests, set the <code class="docutils literal notranslate"><span class="pre">MONITOR_CONFIG</span></code> and <code class="docutils literal notranslate"><span class="pre">COSMO_CONFIG</span></code> environment variables to the test configuration
that’s included with the repository: <code class="docutils literal notranslate"><span class="pre">cosmo/tests/cosmoconfig_tests.yaml</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If tests are executed before setting the <code class="docutils literal notranslate"><span class="pre">MONITOR_CONFIG</span></code> and <code class="docutils literal notranslate"><span class="pre">COSMO_CONFIG</span></code> environment variables to the test
configuration file, the tests <em>will not execute</em>.</p>
</div>
<p>If you’re in the project directory, you can execute the tests with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span>
</pre></div>
</div>
<p>For executing the tests with coverage (after <code class="docutils literal notranslate"><span class="pre">coverage</span></code> has been installed), use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coverage</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span>
</pre></div>
</div>
</div>
<div class="section" id="executing-monitors">
<h2>Executing Monitors<a class="headerlink" href="#executing-monitors" title="Permalink to this headline">¶</a></h2>
<p>Monitors can be executed by using the monitoring classes directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cosmo.monitors</span> <span class="kn">import</span> <span class="n">AcqImageMonitor</span>

<span class="n">monitor</span> <span class="o">=</span> <span class="n">AcqImageMonitor</span><span class="p">()</span>

<span class="c1"># Run it</span>
<span class="n">monitor</span><span class="o">.</span><span class="n">monitor</span><span class="p">()</span>
</pre></div>
</div>
<p>Or, they can be executed from the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(cosmoenv) mycomputer:~ user$ cosmo --monthly
</pre></div>
</div>
<p>For more command line options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(cosmoenv) mycomputer:~ user$ cosmo --help
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="monitors.html" class="btn btn-neutral float-right" title="COS Monitors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="COSMO (COS Monitoring)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Association of Universities for Research in Astronomy.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>